---
- name: deployment
  hosts: all
  become: true
  vars:
    nexus_url: http://3.111.74.62:8081/repository
    repository_type: java-maven-war-app-releases
    group_id: com%2Fmycompany%2Fapp
    artifact_id: hello-world-war
    version: 2.0.3
  tasks:
  - name: Download file from a file path
    ansible.builtin.get_url:
      url: "{{nexus_url}}/{{repository_type}}/{{group_id}}%2F{{artifact_id}}%2F{{version}}%2F{{artifact_id}}-{{version}}.war"
      dest: /home/ec2-user
      username: admin
      password: admin

  - name: Rename war file
    ansible.builtin.shell: mv /home/ec2-user/{{group_id}}%2F{{artifact_id}}%2F{{version}}%2F{{artifact_id}}-{{version}}.war /home/ec2-user/thetwinningdeployment.war

  - name: Deploying artifact in webapps
    ansible.builtin.shell: cp /home/ec2-user/thetwinningdeployment.war /bin/apache-tomcat-9.0.105/webapps/thetwinningdeployment.war

